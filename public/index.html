<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nail Studio - Uñas Hermosas, Confianza en Ti</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="https://cdn-icons-png.flaticon.com/128/1658/1658273.png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>Nail Studio</h2>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#home" class="nav-link">Inicio</a>
                </li>
                <li class="nav-item">
                    <a href="#about" class="nav-link">Acerca de</a>
                </li>
                <li class="nav-item">
                    <a href="#services" class="nav-link">Servicios y Precios</a>
                </li>
                <li class="nav-item">
                    <a href="#gallery" class="nav-link">Galería</a>
                </li>
                                                <li class="nav-item">
                    <a href="#contact" class="nav-link">Contacto</a>
                </li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-container">
            <div class="hero-content">
                <h1>Bienvenida a Tu Momento de Calma</h1>
                <p>Sumérgete en un oasis de tranquilidad mientras nuestras especialistas cuidan de tus manos y pies. Cada visita es una experiencia diseñada para rejuvenecer tu cuerpo y espíritu.</p>
                <button class="cta-button" onclick="scrollToBooking()">Reserva Tu Cita</button>
            </div>
            <div class="hero-image">
                <img src="https://as1.ftcdn.net/v2/jpg/08/18/89/60/1000_F_818896026_utdd9eSZE3vddgItrlrn0JivhlSN47xO.jpg" alt="Beautiful Nails">
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about">
        <div class="container">
            <div class="about-content">
                <div class="about-text">
                    <h2>La Perfección de Uñas Comienza Aquí</h2>
                    <p>En Nail Studio, creemos que las uñas hermosas no son solo un lujo, sino una forma de autoexpresión. Nuestras expertas técnicas combinan arte y precisión para entregar resultados impresionantes que superan tus expectativas.</p>
                    <button class="secondary-button" onclick="scrollToServices()">Ver Nuestros Servicios</button>
                </div>
                <div class="about-image">
                    <img src="https://images.unsplash.com/photo-1519014816548-bf5fe059798b?auto=format&fit=crop&w=800&q=80" alt="Nail Studio Professional">
                </div>
            </div>
        </div>
    </section>

    <!-- Welcome Section -->
    <section class="welcome">
        <div class="container">
            <div class="welcome-content">
                <h2>Uñas Hermosas, Confianza en Ti</h2>
                <p>Transforma tu look con nuestros servicios premium de uñas y experimenta el arte de la perfección.</p>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section id="services" class="services">
        <div class="container">
            <h2>Nuestros Servicios y Precios</h2>
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-image">
                        <img src="https://images.pexels.com/photos/3997391/pexels-photo-3997391.jpeg?auto=compress&cs=tinysrgb&w=400" alt="Classic Manicure">
                    </div>
                    <div class="service-info">
                        <h3>Manicura Clásica</h3>
                        <p>Cuidado tradicional de uñas con tratamiento de cutículas y aplicación de esmalte</p>
                        <span class="price">$25</span>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-image">
                        <img src="https://images.pexels.com/photos/3997391/pexels-photo-3997391.jpeg?auto=compress&cs=tinysrgb&w=400" alt="Gel Manicure">
                    </div>
                    <div class="service-info">
                        <h3>Manicura de Gel</h3>
                        <p>Esmalte de gel de larga duración con alto brillo y durabilidad</p>
                        <span class="price">$45</span>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-image">
                        <img src="https://images.pexels.com/photos/3997391/pexels-photo-3997391.jpeg?auto=compress&cs=tinysrgb&w=400" alt="Nail Art">
                    </div>
                    <div class="service-info">
                        <h3>Diseño de Arte en Uñas</h3>
                        <p>Diseños artísticos personalizados y expresiones creativas en uñas</p>
                        <span class="price">$35+</span>
                    </div>
                </div>
                <div class="service-card">
                    <div class="service-image">
                        <img src="https://images.pexels.com/photos/3997391/pexels-photo-3997391.jpeg?auto=compress&cs=tinysrgb&w=400" alt="Pedicure">
                    </div>
                    <div class="service-info">
                        <h3>Pedicura Spa</h3>
                        <p>Tratamiento de pies lujoso con exfoliación y masaje</p>
                        <span class="price">$40</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="contact" class="booking">
        <!-- Cal inline embed code begins -->
        <h2>Reserva tu Cita</h2>
        <div style="width:100%;height:100%;overflow:scroll" id="my-cal-inline-esmaltados"></div>
        <script type="text/javascript">
          (function (C, A, L) { let p = function (a, ar) { a.q.push(ar); }; let d = C.document; C.Cal = C.Cal || function () { let cal = C.Cal; let ar = arguments; if (!cal.loaded) { cal.ns = {}; cal.q = cal.q || []; d.head.appendChild(d.createElement("script")).src = A; cal.loaded = true; } if (ar[0] === L) { const api = function () { p(api, arguments); }; const namespace = ar[1]; api.q = api.q || []; if(typeof namespace === "string"){cal.ns[namespace] = cal.ns[namespace] || api;p(cal.ns[namespace], ar);p(cal, ["initNamespace", namespace]);} else p(cal, ar); return;} p(cal, ar); }; })(window, "https://app.cal.com/embed/embed.js", "init");
        Cal("init", "esmaltados", {origin:"https://app.cal.com"});

          Cal.ns.esmaltados("inline", {
            elementOrSelector:"#my-cal-inline-esmaltados",
            config: {"layout":"month_view","useSlotsViewOnSmallScreen":"true","theme":"light"},
            calLink: "guillesrl/",
          });

          Cal.ns.esmaltados("ui", {"theme":"light","hideEventTypeDetails":false,"layout":"month_view"});
          
          // Debug: Log all Cal.com events
          console.log('Cal.com initialized, setting up event listeners...');
          
          // Try multiple events to catch the booking cal.com
          Cal.ns.esmaltados("on", {
            action: "bookingSuccessful",
            callback: async function(event) {
              console.log('bookingSuccessful event triggered:', event);
              await saveBookingToDatabase(event);
            }
          });
          
          Cal.ns.esmaltados("on", {
            action: "bookingCompleted",
            callback: async function(event) {
              console.log('bookingCompleted event triggered:', event);
              await saveBookingToDatabase(event);
            }
          });
          
          Cal.ns.esmaltados("on", {
            action: "bookingCreated",
            callback: async function(event) {
              console.log('bookingCreated event triggered:', event);
              await saveBookingToDatabase(event);
            }
          });
          
          // Also try to listen for form submissions
          setTimeout(() => {
            const calForm = document.querySelector('#my-cal-inline-esmaltados form, #my-cal-inline-esmaltados [data-cal-booking-form]');
            if (calForm) {
              console.log('Found Cal.com form, adding submit listener');
              calForm.addEventListener('submit', async function(e) {
                console.log('Cal.com form submitted:', e);
                // Try to get form data
                const formData = new FormData(calForm);
                console.log('Form data:', Object.fromEntries(formData));
              });
            }
          }, 2000);
          
          async function saveBookingToDatabase(event) {
            try {
              console.log('Full event data:', JSON.stringify(event, null, 2));
              
              // Try different paths to get the data
              const bookingData = {
                nombre: event.data?.responses?.name || event.name || event.responses?.name || 'Unknown',
                email: event.data?.responses?.email || event.email || event.responses?.email || 'unknown@example.com',
                fecha: event.data?.startTime || event.startTime || event.date || new Date().toISOString(),
                evento: event.data?.title || event.title || event.eventType || 'Reserva Nail Studio'
              };
              
              console.log('Prepared booking data:', bookingData);
              
              // Send data to your backend API to save to PostgreSQL
              const response = await fetch('/api/reservas', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify(bookingData)
              });
              
              console.log('API response status:', response.status);
              console.log('API response ok:', response.ok);
              
              if (response.ok) {
                const result = await response.json();
                console.log('Reservation saved to database:', result);
                showSuccessMessage('¡Cita reservada exitosamente!');
              } else {
                const errorText = await response.text();
                console.error('Error saving reservation to database:', errorText);
                showErrorMessage('Error al guardar la reserva en la base de datos');
              }
            } catch (error) {
              console.error('Error saving booking:', error);
              showErrorMessage('Error de conexión al guardar la reserva');
            }
          }
          
          function showSuccessMessage(message) {
            showMessage(message, '#4caf50');
          }
          
          function showErrorMessage(message) {
            showMessage(message, '#f44336');
          }
          
          function showMessage(message, backgroundColor) {
            // Create and show a message
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `
              position: fixed;
              top: 20px;
              right: 20px;
              background: ${backgroundColor};
              color: white;
              padding: 15px 20px;
              border-radius: 5px;
              z-index: 1000;
              font-family: 'Poppins', sans-serif;
              max-width: 300px;
            `;
            messageDiv.textContent = message;
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
              if (document.body.contains(messageDiv)) {
                document.body.removeChild(messageDiv);
              }
            }, 5000);
          }
          </script>
          <!-- Cal inline embed code ends -->
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Nail Studio</h3>
                    <p>Uñas Hermosas, Confianza en Ti</p>
                </div>
                <div class="footer-section">
                    <h4>Información de Contacto</h4>
                    <p>Teléfono: (555) 123-4567</p>
                    <p>Email: info@nailstudio.com</p>
                    <p>Dirección: Calle Belleza 123, Ciudad, Estado 12345</p>
                </div>
                <div class="footer-section">
                    <h4>Horario</h4>
                    <p>Lunes - Viernes: 9:00 AM - 7:00 PM</p>
                    <p>Sábado: 9:00 AM - 5:00 PM</p>
                    <p>Domingo: Cerrado</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Nail Studio. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>
